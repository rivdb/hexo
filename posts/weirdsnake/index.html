<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Analyzing bytecode to reverse engineer an XOR key">
<meta property="og:type" content="article">
<meta property="og:title" content="Weird Snake">
<meta property="og:url" content="https://rivers.sh/posts/weirdsnake/index.html">
<meta property="og:site_name" content="River">
<meta property="og:description" content="Analyzing bytecode to reverse engineer an XOR key">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-11-02T04:00:00.000Z">
<meta property="article:modified_time" content="2025-01-15T22:48:32.410Z">
<meta property="article:author" content="River">
<meta property="article:tag" content="Medium">
<meta property="article:tag" content="Reverse Engineering">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Bytecode">
<meta property="article:tag" content="XOR">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Weird Snake</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
    <!-- mathjax -->
    
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/posts/shop/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/posts/packer/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://rivers.sh/posts/weirdsnake/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://rivers.sh/posts/weirdsnake/&text=Weird Snake"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://rivers.sh/posts/weirdsnake/&is_video=false&description=Weird Snake"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Weird Snake&body=Check out this article: https://rivers.sh/posts/weirdsnake/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://rivers.sh/posts/weirdsnake/&name=Weird Snake&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://rivers.sh/posts/weirdsnake/&t=Weird Snake"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-Info"><span class="toc-number">1.</span> <span class="toc-text">Challenge Info</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-understanding"><span class="toc-number">2.</span> <span class="toc-text">Basic understanding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Defining-constants-loading-values-into-input-list"><span class="toc-number">3.</span> <span class="toc-text">Defining constants, loading values into input_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initializing-key-str"><span class="toc-number">4.</span> <span class="toc-text">Initializing key_str</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Generating-key-list"><span class="toc-number">5.</span> <span class="toc-text">Generating key_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extending-key-list-if-it%E2%80%99s-shorter-than-input-list"><span class="toc-number">6.</span> <span class="toc-text">Extending key_list if it’s shorter than input_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XOR-Operation-between-input-list-and-key-list"><span class="toc-number">7.</span> <span class="toc-text">XOR Operation between input_list and key_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Converting-result-into-text"><span class="toc-number">8.</span> <span class="toc-text">Converting result into text</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">9.</span> <span class="toc-text">Solution</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Weird Snake
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">River</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-11-02T04:00:00.000Z" class="dt-published" itemprop="datePublished">2024-11-02</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a> › <a class="category-link" href="/categories/CTF/picoCTF/">picoCTF</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Bytecode/" rel="tag">Bytecode</a>, <a class="p-category" href="/tags/Medium/" rel="tag">Medium</a>, <a class="p-category" href="/tags/Python/" rel="tag">Python</a>, <a class="p-category" href="/tags/Reverse-Engineering/" rel="tag">Reverse Engineering</a>, <a class="p-category" href="/tags/XOR/" rel="tag">XOR</a>
    </div>


    </div>
  </header>
  
  <!-- Display the description -->
  <div class="post-description">Analyzing bytecode to reverse engineer an XOR key</div>

  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Challenge-Info"><a href="#Challenge-Info" class="headerlink" title="Challenge Info"></a>Challenge Info</h2><p>I have a friend that enjoys coding and he hasn’t stopped talking about a snake recently He left this <a target="_blank" rel="noopener" href="https://artifacts.picoctf.net/c_titan/124/snake">file</a> on my computer and dares me to uncover a secret phrase from it. Can you assist?</p>
<p>The code for your convenience:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  1           0 LOAD_CONST               0 (4)</span><br><span class="line">              2 LOAD_CONST               1 (54)</span><br><span class="line">              4 LOAD_CONST               2 (41)</span><br><span class="line">              6 LOAD_CONST               3 (0)</span><br><span class="line">              8 LOAD_CONST               4 (112)</span><br><span class="line">             10 LOAD_CONST               5 (32)</span><br><span class="line">             12 LOAD_CONST               6 (25)</span><br><span class="line">             14 LOAD_CONST               7 (49)</span><br><span class="line">             16 LOAD_CONST               8 (33)</span><br><span class="line">             18 LOAD_CONST               9 (3)</span><br><span class="line">             20 LOAD_CONST               3 (0)</span><br><span class="line">             22 LOAD_CONST               3 (0)</span><br><span class="line">             24 LOAD_CONST              10 (57)</span><br><span class="line">             26 LOAD_CONST               5 (32)</span><br><span class="line">             28 LOAD_CONST              11 (108)</span><br><span class="line">             30 LOAD_CONST              12 (23)</span><br><span class="line">             32 LOAD_CONST              13 (48)</span><br><span class="line">             34 LOAD_CONST               0 (4)</span><br><span class="line">             36 LOAD_CONST              14 (9)</span><br><span class="line">             38 LOAD_CONST              15 (70)</span><br><span class="line">             40 LOAD_CONST              16 (7)</span><br><span class="line">             42 LOAD_CONST              17 (110)</span><br><span class="line">             44 LOAD_CONST              18 (36)</span><br><span class="line">             46 LOAD_CONST              19 (8)</span><br><span class="line">             48 LOAD_CONST              11 (108)</span><br><span class="line">             50 LOAD_CONST              16 (7)</span><br><span class="line">             52 LOAD_CONST               7 (49)</span><br><span class="line">             54 LOAD_CONST              20 (10)</span><br><span class="line">             56 LOAD_CONST               0 (4)</span><br><span class="line">             58 LOAD_CONST              21 (86)</span><br><span class="line">             60 LOAD_CONST              22 (43)</span><br><span class="line">             62 LOAD_CONST              23 (106)</span><br><span class="line">             64 LOAD_CONST              24 (123)</span><br><span class="line">             66 LOAD_CONST              25 (89)</span><br><span class="line">             68 LOAD_CONST              26 (87)</span><br><span class="line">             70 LOAD_CONST              27 (18)</span><br><span class="line">             72 LOAD_CONST              28 (62)</span><br><span class="line">             74 LOAD_CONST              29 (47)</span><br><span class="line">             76 LOAD_CONST              20 (10)</span><br><span class="line">             78 LOAD_CONST              30 (78)</span><br><span class="line">             80 BUILD_LIST              40</span><br><span class="line">             82 STORE_NAME               0 (input_list)</span><br><span class="line"></span><br><span class="line">  2          84 LOAD_CONST              31 (&#x27;J&#x27;)</span><br><span class="line">             86 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">  3          88 LOAD_CONST              32 (&#x27;_&#x27;)</span><br><span class="line">             90 LOAD_NAME                1 (key_str)</span><br><span class="line">             92 BINARY_ADD</span><br><span class="line">             94 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">  4          96 LOAD_NAME                1 (key_str)</span><br><span class="line">             98 LOAD_CONST              33 (&#x27;o&#x27;)</span><br><span class="line">            100 BINARY_ADD</span><br><span class="line">            102 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">  5         104 LOAD_NAME                1 (key_str)</span><br><span class="line">            106 LOAD_CONST              34 (&#x27;3&#x27;)</span><br><span class="line">            108 BINARY_ADD</span><br><span class="line">            110 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">  6         112 LOAD_CONST              35 (&#x27;t&#x27;)</span><br><span class="line">            114 LOAD_NAME                1 (key_str)</span><br><span class="line">            116 BINARY_ADD</span><br><span class="line">            118 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">  9         120 LOAD_CONST              36 (&lt;code object &lt;listcomp&gt; at 0x7f704e8a4d40, file &quot;snake.py&quot;, line 9&gt;)</span><br><span class="line">            122 LOAD_CONST              37 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">            124 MAKE_FUNCTION            0</span><br><span class="line">            126 LOAD_NAME                1 (key_str)</span><br><span class="line">            128 GET_ITER</span><br><span class="line">            130 CALL_FUNCTION            1</span><br><span class="line">            132 STORE_NAME               2 (key_list)</span><br><span class="line"></span><br><span class="line"> 11     &gt;&gt;  134 LOAD_NAME                3 (len)</span><br><span class="line">            136 LOAD_NAME                2 (key_list)</span><br><span class="line">            138 CALL_FUNCTION            1</span><br><span class="line">            140 LOAD_NAME                3 (len)</span><br><span class="line">            142 LOAD_NAME                0 (input_list)</span><br><span class="line">            144 CALL_FUNCTION            1</span><br><span class="line">            146 COMPARE_OP               0 (&lt;)</span><br><span class="line">            148 POP_JUMP_IF_FALSE      162</span><br><span class="line"></span><br><span class="line"> 12         150 LOAD_NAME                2 (key_list)</span><br><span class="line">            152 LOAD_METHOD              4 (extend)</span><br><span class="line">            154 LOAD_NAME                2 (key_list)</span><br><span class="line">            156 CALL_METHOD              1</span><br><span class="line">            158 POP_TOP</span><br><span class="line">            160 JUMP_ABSOLUTE          134</span><br><span class="line"></span><br><span class="line"> 15     &gt;&gt;  162 LOAD_CONST              38 (&lt;code object &lt;listcomp&gt; at 0x7f704e8a4df0, file &quot;snake.py&quot;, line 15&gt;)</span><br><span class="line">            164 LOAD_CONST              37 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">            166 MAKE_FUNCTION            0</span><br><span class="line">            168 LOAD_NAME                5 (zip)</span><br><span class="line">            170 LOAD_NAME                0 (input_list)</span><br><span class="line">            172 LOAD_NAME                2 (key_list)</span><br><span class="line">            174 CALL_FUNCTION            2</span><br><span class="line">            176 GET_ITER</span><br><span class="line">            178 CALL_FUNCTION            1</span><br><span class="line">            180 STORE_NAME               6 (result)</span><br><span class="line"></span><br><span class="line"> 18         182 LOAD_CONST              39 (&#x27;&#x27;)</span><br><span class="line">            184 LOAD_METHOD              7 (join)</span><br><span class="line">            186 LOAD_NAME                8 (map)</span><br><span class="line">            188 LOAD_NAME                9 (chr)</span><br><span class="line">            190 LOAD_NAME                6 (result)</span><br><span class="line">            192 CALL_FUNCTION            2</span><br><span class="line">            194 CALL_METHOD              1</span><br><span class="line">            196 STORE_NAME              10 (result_text)</span><br><span class="line">            198 LOAD_CONST              40 (None)</span><br><span class="line">            200 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f704e8a4d40, file &quot;snake.py&quot;, line 9&gt;:</span><br><span class="line">  9           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                12 (to 18)</span><br><span class="line">              6 STORE_FAST               1 (char)</span><br><span class="line">              8 LOAD_GLOBAL              0 (ord)</span><br><span class="line">             10 LOAD_FAST                1 (char)</span><br><span class="line">             12 CALL_FUNCTION            1</span><br><span class="line">             14 LIST_APPEND              2</span><br><span class="line">             16 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   18 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x7f704e8a4df0, file &quot;snake.py&quot;, line 15&gt;:</span><br><span class="line"> 15           0 BUILD_LIST               0</span><br><span class="line">              2 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    4 FOR_ITER                16 (to 22)</span><br><span class="line">              6 UNPACK_SEQUENCE          2</span><br><span class="line">              8 STORE_FAST               1 (a)</span><br><span class="line">             10 STORE_FAST               2 (b)</span><br><span class="line">             12 LOAD_FAST                1 (a)</span><br><span class="line">             14 LOAD_FAST                2 (b)</span><br><span class="line">             16 BINARY_XOR</span><br><span class="line">             18 LIST_APPEND              2</span><br><span class="line">             20 JUMP_ABSOLUTE            4</span><br><span class="line">        &gt;&gt;   22 RETURN_VALUE</span><br></pre></td></tr></table></figure>

<h2 id="Basic-understanding"><a href="#Basic-understanding" class="headerlink" title="Basic understanding"></a>Basic understanding</h2><p>Right away, we should notice the challenge is to reverse engineer an XOR key. Not only is <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/xor-cipher/">XOR</a> explicitly mentioned towards the bottom of the bytecode dump, but the bitwise operations between the two data sets, <code>input_list</code> and <code>key_list</code> (which we will dive into) gives it away.</p>
<h2 id="Defining-constants-loading-values-into-input-list"><a href="#Defining-constants-loading-values-into-input-list" class="headerlink" title="Defining constants, loading values into input_list"></a>Defining constants, loading values into <code>input_list</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1           0 LOAD_CONST               0 (4)</span><br><span class="line">            2 LOAD_CONST               1 (54)</span><br><span class="line">            4 LOAD_CONST               2 (41)</span><br><span class="line">           80 BUILD_LIST              40</span><br><span class="line">           82 STORE_NAME               0 (input_list)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>LOAD_CONST</code> is called to loads several constant values onto the stack.<ul>
<li>4, 54, 41, etc. are being loaded.</li>
</ul>
</li>
<li><code>BUILD_LIST</code> is called, it combines the constants that were loaded into a single list. The number <strong>40</strong> in <code>BUILD_LIST 40</code> tells the (Python) interpret that the list will contain 40 values.</li>
<li><code>STORE_NAME</code> assigns the list to a variable named “input_list”</li>
</ul>
<p>This may seem complicated, but the Python code for this looks something like:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_list = [<span class="number">4</span>, <span class="number">54</span>, <span class="number">41</span>, <span class="number">0</span>, <span class="number">112</span>, <span class="number">32</span>, <span class="number">25</span>, <span class="number">49</span>, <span class="number">33</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">32</span>, ...]</span><br></pre></td></tr></table></figure>
<h2 id="Initializing-key-str"><a href="#Initializing-key-str" class="headerlink" title="Initializing key_str"></a>Initializing <code>key_str</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">84 LOAD_CONST              31 (&#x27;J&#x27;)</span><br><span class="line">86 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">88 LOAD_CONST              32 (&#x27;_&#x27;)</span><br><span class="line">90 LOAD_NAME                1 (key_str)</span><br><span class="line">92 BINARY_ADD</span><br><span class="line">94 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">96 LOAD_NAME                1 (key_str)</span><br><span class="line">98 LOAD_CONST              33 (&#x27;o&#x27;)</span><br><span class="line">100 BINARY_ADD</span><br><span class="line">102 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">104 LOAD_NAME                1 (key_str)</span><br><span class="line">106 LOAD_CONST              34 (&#x27;3&#x27;)</span><br><span class="line">108 BINARY_ADD</span><br><span class="line">110 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br><span class="line">112 LOAD_CONST              35 (&#x27;t&#x27;)</span><br><span class="line">114 LOAD_NAME                1 (key_str)</span><br><span class="line">116 BINARY_ADD</span><br><span class="line">118 STORE_NAME               1 (key_str)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>As we can see, many values are loaded onto a “key” <code>variable</code>. If we read it in order, it might seem as though the key is <code>J_o3t</code>. <strong>This is not the case.</strong></p>
<blockquote>
<p>Read carefully, as this was designed to confuse you. The order in which the constant is loaded on the stack determines whether it’s added to the front or the back of the string.<br>{: .prompt-info}</p>
</blockquote>
<ol>
<li></li>
</ol>
<ul>
<li><code>LOAD_CONST (&#39;J&#39;)</code>: This loads a constant “J” onto the stack.</li>
<li><code>STORE_NAME (key_str)</code>: The value at the top of the stack (“J”, in this instance) is popped off the stack and assigned to the variable <code>key_str</code>.<ul>
<li><code>key_str = &quot;J&quot;</code>.</li>
</ul>
</li>
</ul>
<ol start="2">
<li></li>
</ol>
<ul>
<li><code>LOAD_CONST (&#39;_&#39;)</code>: This loads a constant “_“ onto the stack.</li>
<li><code>LOAD_NAME (key_str)</code>: This loads <code>key_str</code>, which is currently just “J”, as previously explained.</li>
<li><code>BINARY_ADD</code>: Combines both <code>_</code> and <code>key_str</code> (again, currently just “J”).</li>
<li><code>STORE_NAME (key_str)</code>: Stores these changes to <code>key_str</code>.<ul>
<li><code>key_str = &quot;J&quot;</code> –&gt; <code>key_str = &quot;_J&quot;</code>.</li>
</ul>
</li>
</ul>
<ol start="3">
<li></li>
</ol>
<ul>
<li><code>LOAD_NAME (key_str)</code>: This loads <code>key_str</code>.</li>
<li><code>LOAD_CONST (&#39;o&#39;)</code>: This loads a constant “o” onto the stack.</li>
<li><code>BINARY_ADD</code>: Combines both “O” and <code>key-str</code>, effectively adding “” to <code>key_str</code>.</li>
<li><code>STORE_NAME (key_str)</code>: Stores these changes to <code>key_str</code>.<ul>
<li><code>key_str = &quot;_J&quot;</code> –&gt; <code>key_str = &quot;_Jo&quot;</code>.</li>
</ul>
</li>
</ul>
<ol start="4">
<li></li>
</ol>
<ul>
<li><code>LOAD_NAME (key_str)</code> This loads <code>key_str</code>.</li>
<li><code>LOAD_CONST (&#39;3&#39;)</code>: This loads a constant “3” onto the stack.</li>
<li><code>BINARY_ADD</code>: This combine “3” and <code>key_str</code>.</li>
<li><code>STORE_NAME (key_str)</code>: Stores this to <code>key-str</code>.<ul>
<li><code>key_str = &quot;_Jo&quot;</code> –&gt; <code>key_str = &quot;_Jo3&quot;</code>.</li>
</ul>
</li>
</ul>
<ol start="5">
<li></li>
</ol>
<ul>
<li><code>LOAD_CONST (&#39;t&#39;)</code>: This loads a constant “t” onto the stack.</li>
<li><code>LOAD_NAME (key_str)</code>: This loads <code>key_str</code>.</li>
<li><code>BINARY_ADD</code>: This combine “t” and <code>key-str</code>.</li>
<li><code>STORE_NAME (key_str)</code>.<ul>
<li><code>key-str = &quot;_Jo3&quot;</code> –&gt; <code>key_str = &quot;t_Jo3&quot;</code>.</li>
</ul>
</li>
</ul>
<h2 id="Generating-key-list"><a href="#Generating-key-list" class="headerlink" title="Generating key_list"></a>Generating <code>key_list</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">120 LOAD_CONST              36 (&lt;code object &lt;listcomp&gt; at 0x7f704e8a4d40, file &quot;snake.py&quot;, line 9&gt;) &gt;)</span><br><span class="line">122 LOAD_CONST              37 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">124 MAKE_FUNCTION            0</span><br><span class="line">126 LOAD_NAME                1 (key_str)</span><br><span class="line">128 GET_ITER</span><br><span class="line">130 CALL_FUNCTION            1</span><br><span class="line">132 STORE_NAME               2 (key_list)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>120 LOAD_C NST 36(&lt;code object &lt;listcomp&gt; at ..., file &quot;snake.py&quot;, line 9&gt;) &gt;)</code>: This loads a constant at index 36 onto the stack, specifically, a code object for a <a target="_blank" rel="noopener" href="https://www.simplilearn.com/tutorials/python-tutorial/list-comprehension-in-python">list comprehension</a>.<ul>
<li>Essentially, a piece of code that will create a list. This code object will be used to generate the list later.</li>
</ul>
</li>
<li><code>122 LOAD_CONST 37 (&#39;&lt;listcomp&gt;&#39;)</code>: This loads a constant at index 37 onto the stack. The constant in this case is the string “&lt;listcomp&gt;”. This will be used to identify this code object as a list comprehension once it’s actually executed.</li>
<li><code>124 MAKE_FUNCTION 0</code>: This is the simplest one, it simply creates a function from the code object and the string “&lt;listcomp&gt;” (which will be used for debugging and identification). When this new function object is called, it’ll execute the list comprehension code.</li>
<li><code>126 LOAD_NAME 1 (key_str)</code>: Loads the <code>key_str</code> variable that was explained in the previous section</li>
<li><code>128 GET_ITER</code>: Takes the value of <code>key_str</code>, which was just loaded, and gets an iterator over it. Assuming that <code>key_str</code> is a string, it’ll iterate over all its characters.</li>
<li><code>130 CALL_FUNCTION 1</code>: Calls the function was made in step 124, it passes the iterator from <code>key_str</code> as an argument to the list comprehension. The function runs the list comprehension, which will process the characters from <code>key_str</code>.</li>
<li><code>132 STORE_NAME 2 (key_list)</code>: The result of the list that was just made is stored in a variable named <code>key_list</code>. This is simply the final output of the list comprehension.</li>
</ul>
<p>In python, this might look something like this:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key_list = [<span class="built_in">ord</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> key]</span><br></pre></td></tr></table></figure>

<p>This is a simple list comprehension, where each elemtn in the list is an item&#x2F;character from <code>key_str</code>.</p>
<h2 id="Extending-key-list-if-it’s-shorter-than-input-list"><a href="#Extending-key-list-if-it’s-shorter-than-input-list" class="headerlink" title="Extending key_list if it’s shorter than input_list"></a>Extending <code>key_list</code> if it’s shorter than <code>input_list</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">134 LOAD_NAME                3 (len)</span><br><span class="line">136 LOAD_NAME                2 (key_list)</span><br><span class="line">138 CALL_FUNCTION            1</span><br><span class="line">140 LOAD_NAME                3 (len)</span><br><span class="line">142 LOAD_NAME                0 (input_list)</span><br><span class="line">144 CALL_FUNCTION            1</span><br><span class="line">146 COMPARE_OP               0 (&lt;)</span><br><span class="line">148 POP_JUMP_IF_FALSE      162</span><br><span class="line"></span><br><span class="line">150 LOAD_NAME                2 (key_list)</span><br><span class="line">152 LOAD_METHOD              4 (extend)</span><br><span class="line">154 LOAD_NAME                2 (key_list)</span><br><span class="line">156 CALL_METHOD              1</span><br><span class="line">158 POP_TOP</span><br><span class="line">160 JUMP_ABSOLUTE          134</span><br></pre></td></tr></table></figure>
<p><strong>The first half (before the line break):</strong></p>
<ul>
<li>Check lengths:<ul>
<li><code>len(key_list)</code> is compared to <code>len(input_list)</code>.</li>
<li>If <code>key_list</code> is shorter, then it is extended.</li>
<li>Otherwise, it just skips to the next part of the code.</li>
</ul>
</li>
</ul>
<p><strong>The second half (after the line break)</strong></p>
<ul>
<li>Extend <code>key_list</code>:<ul>
<li><code>key_list.extend(key_list)</code> duplicates <code>key_list</code> by adding its contents to itself.</li>
<li>After extending, the program jumps back (<code>JUMP_ABSOLUTE 134</code>) to recheck the lengths.</li>
<li>The program will continue to loop until <code>len(key_list)</code> is &gt;&#x3D; <code>len_(input_list)</code>.</li>
</ul>
</li>
</ul>
<p>An example of how this might work:</p>
<ul>
<li>Initial Values:</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">input_list = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>After extending once:</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h2 id="XOR-Operation-between-input-list-and-key-list"><a href="#XOR-Operation-between-input-list-and-key-list" class="headerlink" title="XOR Operation between input_list and key_list"></a>XOR Operation between <code>input_list</code> and <code>key_list</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">162 LOAD_CONST              38 (&lt;code object &lt;listcomp&gt; at ...&gt;)</span><br><span class="line">164 LOAD_CONST              37 (&#x27;&lt;listcomp&gt;&#x27;)</span><br><span class="line">166 MAKE_FUNCTION            0</span><br><span class="line">168 LOAD_NAME                5 (zip)</span><br><span class="line">170 LOAD_NAME                0 (input_list)</span><br><span class="line">172 LOAD_NAME                2 (key_list)</span><br><span class="line">174 CALL_FUNCTION            2</span><br><span class="line">176 GET_ITER</span><br><span class="line">178 CALL_FUNCTION            1</span><br><span class="line">180 STORE_NAME               6 (result)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Offsets <code>162 - 166</code>:</p>
<ul>
<li>A code object for a list comprehension is loaded onto the stack.</li>
<li>A name label for the list comprehension (<code>&lt;listcomp&gt;</code>) is loaded, which is used solely for debugging purposes, like I mentioned previously.</li>
<li>The compiled code and its label are combined into a callable function that will execute the list comprehension once it’s called.</li>
<li>This list comprehension would look something like this:<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = [a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(input_list, key_list)]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Offsets <code>168</code>:</p>
<ul>
<li>The built-in <code>zip</code> function is loaded onto the stack.</li>
<li>This function will combine <code>input_list</code> and <code>key_list</code> into pairs.</li>
</ul>
</li>
<li><p>Offsets <code>170 - 172</code>:</p>
<ul>
<li>The variables <code>input_list</code> and <code>key_list</code> are loaded onto the stack.</li>
<li>Example:<ul>
<li><code>input_list = [4, 54, 41]</code>, <code>key_list = [116, 95, 74]</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Note that these aren’t the actual values, I’m just using them as an example.<br>{: .prompt-info }</p>
</blockquote>
<ul>
<li>Offsets <code>174 - 180</code>:<ul>
<li>The <code>zip</code> function is called with 2 arguments: <code>input_list</code> and <code>key_list</code>. The result is an iterator of pairs like: <code>[(4, 116), (54, 95), (41, 74)]</code>.</li>
<li><code>CALL_FUNCTION (1)</code>: the function created for the list comprehension is called with the iterator of pairs.</li>
<li><code>STORE_NAME (result)</code>: The list that was just created from the list comprehension is stored in the variable <code>result</code>.</li>
</ul>
</li>
</ul>
<p>So, the list comprehension should:</p>
<ul>
<li>Iterate through each pair (a, b) from the zipped object.</li>
<li>Compute the XOR (a^b).</li>
<li>Add these results to the new list called <code>result</code></li>
</ul>
<h2 id="Converting-result-into-text"><a href="#Converting-result-into-text" class="headerlink" title="Converting result into text"></a>Converting result into text</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">182 LOAD_CONST              39 (&#x27;&#x27;)</span><br><span class="line">184 LOAD_METHOD              7 (join)</span><br><span class="line">186 LOAD_NAME                8 (map)</span><br><span class="line">188 LOAD_NAME                9 (chr)</span><br><span class="line">190 LOAD_NAME                6 (result)</span><br><span class="line">192 CALL_FUNCTION            2</span><br><span class="line">194 CALL_METHOD              1</span><br><span class="line">196 STORE_NAME              10 (result_text)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>result</code> (which is a list of integers) is converted into characters using <code>chr()</code>.</li>
<li>These characters are then joined into a single string using <code>&#39;&#39;.join()</code>.</li>
<li>The final output is stored into <code>result_text</code> (our flag!).</li>
</ul>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">input_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;snake&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        start = line.find(<span class="string">&quot;(&quot;</span>)</span><br><span class="line">        end = line.find(<span class="string">&quot;)&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> start != -<span class="number">1</span> <span class="keyword">and</span> end != -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                number = <span class="built_in">int</span>(line[start + <span class="number">1</span>:end])</span><br><span class="line">                input_list.append(number)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;t_Jo3&quot;</span></span><br><span class="line"></span><br><span class="line">key_list = [<span class="built_in">ord</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(key_list) &lt; <span class="built_in">len</span>(input_list):</span><br><span class="line">    key_list.extend(key_list[:<span class="built_in">len</span>(input_list) - <span class="built_in">len</span>(key_list)])</span><br><span class="line"></span><br><span class="line">result = [a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(input_list, key_list)]</span><br><span class="line"></span><br><span class="line">result_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, result))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result_text)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: The <code>with</code> statement before the <code>key</code> is to automatically find the values of <code>input_list</code>. This isn’t necessary of course, it’s just to automate this further.<br>{: .prompt-info }</p>
</blockquote>
<p>flag: <code>picoCTF&#123;N0t_sO_coNfus1ng_sn@ke_516dfaee&#125;</code></p>

  </div>
</article>




        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Archive</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-Info"><span class="toc-number">1.</span> <span class="toc-text">Challenge Info</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-understanding"><span class="toc-number">2.</span> <span class="toc-text">Basic understanding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Defining-constants-loading-values-into-input-list"><span class="toc-number">3.</span> <span class="toc-text">Defining constants, loading values into input_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initializing-key-str"><span class="toc-number">4.</span> <span class="toc-text">Initializing key_str</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Generating-key-list"><span class="toc-number">5.</span> <span class="toc-text">Generating key_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extending-key-list-if-it%E2%80%99s-shorter-than-input-list"><span class="toc-number">6.</span> <span class="toc-text">Extending key_list if it’s shorter than input_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XOR-Operation-between-input-list-and-key-list"><span class="toc-number">7.</span> <span class="toc-text">XOR Operation between input_list and key_list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Converting-result-into-text"><span class="toc-number">8.</span> <span class="toc-text">Converting result into text</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">9.</span> <span class="toc-text">Solution</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://rivers.sh/posts/weirdsnake/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://rivers.sh/posts/weirdsnake/&text=Weird Snake"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://rivers.sh/posts/weirdsnake/&is_video=false&description=Weird Snake"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Weird Snake&body=Check out this article: https://rivers.sh/posts/weirdsnake/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://rivers.sh/posts/weirdsnake/&title=Weird Snake"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://rivers.sh/posts/weirdsnake/&name=Weird Snake&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://rivers.sh/posts/weirdsnake/&t=Weird Snake"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    River
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->


    <!-- Add Oneko.js Script -->
    <script src="/js/oneko.js"></script>
    <script>
      window.onload = function() {
        oneko('/images/oneko.gif'); // This starts the cat chasing the mouse
      };
    </script>
</body>
</html>
